# JavaSTG 代码规范

## 1. 项目结构规范

### 1.1 目录结构

```
src/
├── Main/           # 主入口类
├── stg/            # 核心游戏引擎
│   ├── base/       # 基础组件
│   ├── game/       # 游戏核心逻辑
│   └── util/       # 工具类
└── user/           # 用户自定义内容
    ├── bullet/     # 自定义子弹
    ├── enemy/      # 自定义敌人
    ├── item/       # 自定义道具
    ├── laser/      # 自定义激光
    ├── player/     # 自定义玩家
    └── stage/      # 自定义关卡
```

### 1.2 包命名规范

- 包名全部使用小写字母
- 包名采用反向域名形式
- 核心引擎代码使用 `stg` 作为根包
- 用户自定义代码使用 `user` 作为根包
- 子包名应反映模块功能

## 2. 命名规范

### 2.1 类命名

- 使用大驼峰命名法（PascalCase）
- 类名应反映其功能和职责
- 接口命名以 `I` 开头（如 `IBullet`、`IEnemy`）
- 抽象类命名以 `Abstract` 开头
- 枚举类命名使用大驼峰，枚举值全部大写

### 2.2 方法命名

- 使用小驼峰命名法（camelCase）
- 方法名应是动词或动词短语
- 构造方法与类名相同
- getter 方法使用 `get` 前缀
- setter 方法使用 `set` 前缀
- 布尔类型的 getter 方法使用 `is` 前缀

### 2.3 变量命名

- 使用小驼峰命名法（camelCase）
- 变量名应具有描述性
- 成员变量使用 `m` 前缀（可选）
- 静态变量使用 `s` 前缀（可选）
- 常量全部大写，单词间用下划线分隔
- 局部变量应简洁明了

### 2.4 常量命名

- 全部大写，单词间用下划线分隔
- 使用 `final` 修饰符
- 类级常量放在类的顶部
- 常量名应具有描述性

## 3. 代码风格

### 3.1 缩进和空格

- 使用 4 个空格进行缩进（不使用制表符）
- 运算符两侧各加一个空格
- 逗号后面加一个空格
- 分号后面加一个空格（行尾除外）
- 大括号前后各加一个空格
- 方法参数列表中，参数之间用逗号加空格分隔

### 3.2 大括号风格

- 使用行尾大括号风格
- 类、方法、if/else、for、while 等语句的大括号都使用行尾风格
- 空大括号使用 `{}` 形式

### 3.3 代码长度

- 每行代码长度不超过 120 个字符
- 方法长度不超过 50 行
- 类长度不超过 500 行

### 3.4 导入语句

- 导入语句按以下顺序排列：
  1. Java 标准库导入
  2. 第三方库导入
  3. 项目内部导入
- 相同包的导入语句合并
- 移除未使用的导入语句
- 使用显式导入，避免使用星号导入

## 4. 注释规范

### 4.1 Javadoc 注释

- 类、接口、方法都必须使用 Javadoc 注释
- Javadoc 注释应包含：
  - 功能描述
  - 参数说明（@param）
  - 返回值说明（@return）
  - 异常说明（@throws）
  - 版本信息（@since）
  - 作者信息（@author）
- Javadoc 注释使用 /** */ 格式
- 多行 Javadoc 注释的每行开头使用星号对齐

### 4.2 行注释

- 行注释使用 // 格式
- 行注释应在代码行的上方或右侧
- 注释应简洁明了，解释代码的意图而非实现
- 复杂逻辑应添加注释说明

### 4.3 块注释

- 块注释使用 /* */ 格式
- 块注释用于注释掉代码段或提供详细说明
- 块注释应在被注释代码的上方

### 4.4 注解规范

#### 4.4.1 新增类注解
- 新增类必须在类开头的 Javadoc 注释中添加：
  - @since：添加时间戳，格式为 YYYY-MM-DD
  - @author：添加作者署名

#### 4.4.2 修改内容注解
- 修改原有内容时，应在相关方法或代码块的注释中添加：
  - @date：修改时间戳，格式为 YYYY-MM-DD
  - @author：修改者署名
  - 修改内容描述：简要说明修改的原因和内容

## 5. 异常处理规范

### 5.1 异常类型

- 使用具体的异常类型而非通用的 Exception
- 对于可恢复的错误使用 checked 异常
- 对于不可恢复的错误使用 unchecked 异常

### 5.2 异常处理

- 捕获异常后应进行适当处理，避免空 catch 块
- 异常处理应包括日志记录
- 不要捕获异常后直接忽略
- 不要在 finally 块中抛出新的异常

### 5.3 异常传递

- 方法应在签名中声明可能抛出的 checked 异常
- 避免在底层方法中捕获异常后不处理也不传递

## 6. 性能优化规范

### 6.1 内存管理

- 避免创建不必要的对象
- 使用对象池管理频繁创建的对象
- 及时释放不再使用的资源
- 避免内存泄漏

### 6.2 算法优化

- 使用合适的数据结构
- 优化循环性能
- 避免重复计算
- 合理使用缓存

### 6.3 线程安全

- 注意线程安全问题
- 使用适当的同步机制
- 避免死锁和竞态条件

## 7. 安全规范

### 7.1 输入验证

- 对所有用户输入进行验证
- 避免 SQL 注入、XSS 等安全问题
- 验证文件路径，避免路径遍历攻击

### 7.2 资源访问

- 安全地处理文件和网络资源
- 避免硬编码敏感信息
- 使用安全的随机数生成器

## 8. 测试规范

### 8.1 测试文件结构

- 测试文件与源代码文件放在同一目录
- 测试类命名为 `原类名Test`

### 8.2 测试内容

- 单元测试覆盖核心功能
- 测试边界条件
- 测试异常情况
- 测试性能关键路径

### 8.3 测试框架

- 使用 JUnit 作为测试框架
- 可以使用 Mockito 进行模拟测试

## 9. 代码质量工具

- 使用 Checkstyle 检查代码风格
- 使用 FindBugs 或 SpotBugs 检查潜在问题
- 使用 PMD 检查代码质量
- 使用 JaCoCo 检查代码覆盖率

## 10. 版本控制规范

### 10.1 提交消息

- 提交消息应简洁明了
- 提交消息使用中文
- 提交消息格式：`[模块名] 描述`

### 10.2 分支管理

- `master` 分支：稳定版本
- `develop` 分支：开发版本
- 功能分支：`feature/功能名`
- 修复分支：`fix/问题描述`

## 11. 代码审查规范

- 代码提交前进行自我审查
- 团队成员之间进行代码审查
- 代码审查关注：
  - 代码风格是否符合规范
  - 逻辑是否正确
  - 性能是否优化
  - 安全是否考虑
  - 测试是否充分

---

本规范基于 Java 语言标准规范和项目实际情况制定，旨在提高代码质量和开发效率。所有团队成员应严格遵守本规范。

---

### 落款

**制定日期：** 2026-02-02  
**制定团队：** JavaSTG 团队  